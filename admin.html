<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel ‚Ä¢ ‡§Ö‡§Ç‡§ú‡§≤‡•Ä</title>

  <style>
    body{
      margin:0;
      font-family:"Noto Sans Devanagari", system-ui, sans-serif;
      background:#f4f6f8;
      color:#111;
    }

    header{
      background:#1f2937;
      color:#fff;
      padding:12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    header button{
      border:none;
      padding:8px 14px;
      border-radius:10px;
      cursor:pointer;
      background:#2563eb;
      color:#fff;
      font-size:14px;
    }

    main{
      padding:14px;
      display:flex;
      gap:14px;
      flex-wrap:wrap;
    }

    .panel{
      background:#fff;
      border-radius:14px;
      padding:14px;
      box-shadow:0 6px 18px rgba(0,0,0,.1);
    }

    .form-panel{
      flex:1;
      min-width:280px;
      max-width:520px;
    }

    .list-panel{
      flex:1;
      min-width:260px;
      max-width:420px;
      max-height:75vh;
      overflow:auto;
    }

    h2,h3{
      margin-top:0;
    }

    label{
      display:block;
      font-weight:bold;
      margin-top:10px;
      margin-bottom:4px;
    }

    textarea{
      width:100%;
      box-sizing:border-box;
      min-height:90px;
      padding:10px;
      font-size:15px;
      border-radius:10px;
      border:1px solid #ccc;
      resize:vertical;
    }

    .big{
      min-height:160px;
    }

    .actions{
      margin-top:10px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }

    .actions button{
      border:none;
      border-radius:10px;
      padding:8px 14px;
      cursor:pointer;
      font-size:14px;
      background:#16a34a;
      color:#fff;
    }

    .actions .secondary{
      background:#64748b;
    }

    .item{
      border-bottom:1px solid #eee;
      padding:8px 0;
    }

    .item b{
      display:block;
      margin-bottom:6px;
    }

    .item-actions button{
      margin-right:4px;
      border:none;
      border-radius:6px;
      padding:4px 8px;
      font-size:12px;
      cursor:pointer;
    }

    .delete{ background:#dc2626; color:#fff; }
    .edit{ background:#2563eb; color:#fff; }
    .move{ background:#16a34a; color:#fff; }

    footer{
      text-align:center;
      font-size:12px;
      color:#555;
      margin-top:10px;
    }
  </style>
</head>

<body>

<header>
  <div>üîê Admin Panel ‚Ä¢ ‡§Ö‡§Ç‡§ú‡§≤‡•Ä</div>
  <button onclick="goIndex()">‚¨Ö Index</button>
</header>

<main>

  <!-- ================= FORM PANEL ================= -->
  <section class="panel form-panel">
    <h2>‚ûï ‡§®‡§Ø‡§æ ‡§ú‡•ç‡§û‡§æ‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h2>

    <label>Concept ID (unique)</label>
    <textarea id="cid" placeholder="‡§ú‡•à‡§∏‡•á: constitution_date"></textarea>

    <label>Signals (‡§π‡§∞ ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø ‡§è‡§ï ‡§∏‡§Ç‡§ï‡•á‡§§)</label>
    <textarea id="signals" placeholder="‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§¨&#10;‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§ï‡§¨ ‡§Ö‡§Æ‡§≤ ‡§Æ‡•á‡§Ç ‡§Ü‡§Ø‡§æ"></textarea>

    <label>‡§â‡§§‡•ç‡§§‡§∞ / ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ</label>
    <textarea id="answer" class="big" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§â‡§§‡•ç‡§§‡§∞ ‡§≤‡§ø‡§ñ‡•á‡§Ç‚Ä¶"></textarea>

    <div class="actions">
      <button onclick="addConcept()">üíæ Save</button>
      <button class="secondary" onclick="clearForm()">üßπ Clear</button>
    </div>
  </section>

  <!-- ================= LIST PANEL ================= -->
  <section class="panel list-panel">
    <h3>üìö ‡§∏‡§≠‡•Ä Concepts</h3>
    <div id="list"></div>
  </section>

</main>

<footer>
  Core-safe ‚Ä¢ No Demo ‚Ä¢ Local Knowledge Only
</footer>

<!-- ================= CORE / LEARNING ================= -->

<script src="learning/KnowledgeBase.js"></script>
<script src="learning/ExperienceMemory.js"></script>

<!-- ================= ADMIN LOGIC ================= -->
<script>
  function goIndex(){
    window.location.href = "index.html";
  }

  function clearForm(){
    cid.value="";
    signals.value="";
    answer.value="";
  }

  function addConcept(){
    const id = cid.value.trim();
    const sig = signals.value.split("\n").map(s=>s.trim()).filter(Boolean);
    const ans = answer.value.trim();

    if(!id || !sig.length || !ans){
      alert("‡§∏‡§≠‡•Ä ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡§®‡§æ ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à");
      return;
    }

    KnowledgeBase.addConcept(id, sig, () => ans);
    KnowledgeBase.save();

    clearForm();
    renderList();
  }

  function delConcept(id){
    if(!confirm("‡§ï‡•ç‡§Ø‡§æ ‡§Ø‡§π Concept ‡§π‡§ü‡§æ‡§®‡§æ ‡§π‡•à?")) return;
    KnowledgeBase.removeConcept(id);
    KnowledgeBase.save();
    renderList();
  }

  function editConcept(id){
    const c = KnowledgeBase.getConcept(id);
    if(!c) return;

    cid.value = c.id;
    signals.value = c.signals.join("\n");
    answer.value = c.respond();
  }

  function upConcept(id){
    KnowledgeBase.moveUp(id);
    KnowledgeBase.save();
    renderList();
  }

  function downConcept(id){
    KnowledgeBase.moveDown(id);
    KnowledgeBase.save();
    renderList();
  }

  function renderList(){
    const box = document.getElementById("list");
    box.innerHTML = "";

    KnowledgeBase.getAll().forEach(c=>{
      const div = document.createElement("div");
      div.className="item";
      div.innerHTML = `
        <b>${c.id}</b>
        <div class="item-actions">
          <button class="edit" onclick="editConcept('${c.id}')">‚úèÔ∏è Edit</button>
          <button class="delete" onclick="delConcept('${c.id}')">‚ùå Delete</button>
          <button class="move" onclick="upConcept('${c.id}')">‚¨Ü</button>
          <button class="move" onclick="downConcept('${c.id}')">‚¨á</button>
        </div>
      `;
      box.appendChild(div);
    });
  }

  // initial load
  KnowledgeBase.load();
  renderList();
</script>

</body>
</html>
